@using SFA.DAS.ApprenticeAan.Web.HtmlHelpers
@using SFA.DAS.ApprenticeAan.Web.TagHelpers
@using Microsoft.AspNetCore.Mvc.TagHelpers
@using SFA.DAS.ApprenticeAan.Domain.Constants
@using SFA.DAS.ApprenticeAan.Domain.Extensions
@model NetworkEventsViewModel
@{
    ViewData["Title"] = "Search Network Events";

    var hideSearchElements = "govuk-visually-hidden";
    //hideSearchElements = "";
    var hideFilterElements = "govuk-visually-hidden";
    //hideFilterElements = "";

    var totalCountDescription = $"{Model.TotalCount} results";
    if (Model.TotalCount == 1)
    {
        totalCountDescription = "1 result";
    }
}

<div class="govuk-grid-row">
    <div class="govuk-grid-column-two-thirds">
        <h1 class="govuk-heading-xl govuk-!-margin-bottom-5">Search network events</h1>
        <p>All events listed on this page are relevant to your profile preferences. You can use filters to narrow your search parameters further and find the most suitable events from within your preferred options. </p>
        <form method="POST" role="search" aria-label="On this page">
            <div class="govuk-form-group govuk-!-margin-bottom-9  @hideSearchElements">
                <label for="searchTerm" class="govuk-label">
                    Search for events
                </label>
                <div class="das-search-form__group">
                    <input id="searchTerm" name="searchTerm" title="Search" class="govuk-input das-search-form__input" type="text" value="" placeholder="Search" />
                    <div class="das-search-form__button-wrap">
                        <button class="govuk-button das-search-form__button" type="submit">Search</button>
                    </div>
                </div>
            </div>
        </form>
    </div>
</div>
<div class="govuk-grid-row">
    <div class="govuk-grid-column-one-third">
        <div class="das-show-hide" data-module="das-show-hide">
            <div class="das-filter das-!-show--from-tablet das-show-hide__section" id="events-filter" tabindex="0">
                <div class="das-filter__header">
                    <h2 class="das-filter__heading">Filter</h2>
                </div>
                @if (Model.ShowFilterOptions)
                {
                    <div class="das-filter__selected-filters">
                        <div class="das-filter__selected-header">
                            <h3 class="das-filter__selected-heading">Selected filters</h3>
                            <a class="das-filter__selected-action govuk-link govuk-link--no-visited-state" asp-route="@RouteNames.NetworkEvents">Clear <span class="govuk-visually-hidden">the selected filters</span></a>
                        </div>
                        @if (Model.StartDate != null)
                        {
                            <h4 class="das-filter__selected-sub-heading">From date</h4>
                            <a asp-querystring="@Model.BuildQuery(NetworkEventsViewModel.FilterFields.StartDate)" title="Clear this filter '@DateTimeHelper.ToScreenFormat(Model.StartDate)'" class="das-filter__tag das-breakable">@DateTimeHelper.ToScreenFormat(Model.StartDate)</a>
                        }
                        @if (Model.EndDate != null)
                        {
                            <h4 class="das-filter__selected-sub-heading">To date</h4>
                            <a asp-querystring="@Model.BuildQuery(NetworkEventsViewModel.FilterFields.EndDate)" title="Clear this filter '@DateTimeHelper.ToScreenFormat(Model.EndDate)'" class="das-filter__tag das-breakable">@DateTimeHelper.ToScreenFormat(Model.EndDate)</a>
                        }
                    </div>
                }
                <div class="das-filter__body das-!-show--from-tablet" id="events-filter-options">
                    <form asp-route="@RouteNames.NetworkEvents" method="GET">


                        <button type="submit" class="govuk-button" id="filters-submit">Apply filters</button>
                        <div class="govuk-form-group">
                            <fieldset class="govuk-fieldset">
                                <legend class="govuk-fieldset__legend govuk-fieldset__legend--m">
                                    Event date
                                </legend>
                                <div class="govuk-form-group">
                                    <label class="govuk-label" for="startDate">
                                        From date
                                    </label>
                                    <input class="govuk-input" id="startDate" name="startDate" type="date" value="@DateTimeHelper.ToUrlFormat(Model.StartDate)">
                                </div>
                                <div class="govuk-form-group">
                                    <label class="govuk-label" for="to-date">
                                        To date
                                    </label>
                                    <input class="govuk-input" id="endDate" name="endDate" type="date" value=@DateTimeHelper.ToUrlFormat(Model.EndDate)>
                                </div>
                            </fieldset>
                        </div>
                        <div class="govuk-form-group  @hideFilterElements">
                            <fieldset class="govuk-fieldset">
                                <legend class="govuk-fieldset__legend govuk-fieldset__legend--m">
                                    Event format
                                </legend>
                                <div class="govuk-checkboxes govuk-checkboxes--small">
                                    <div class="govuk-checkboxes__item">
                                        <input class="govuk-checkboxes__input" id="format-person" name="format" type="checkbox" value="person">
                                        <label class="govuk-label govuk-checkboxes__label" for="format-person">
                                            In person
                                        </label>
                                    </div>
                                    <div class="govuk-checkboxes__item">
                                        <input class="govuk-checkboxes__input" id="format-online" name="format" type="checkbox" value="online">
                                        <label class="govuk-label govuk-checkboxes__label" for="format-online">
                                            Online
                                        </label>
                                    </div>
                                    <div class="govuk-checkboxes__item">
                                        <input class="govuk-checkboxes__input" id="format-hybrid" name="format" type="checkbox" value="hybrid">
                                        <label class="govuk-label govuk-checkboxes__label" for="format-hybrid">
                                            Hybrid
                                        </label>
                                    </div>

                                </div>
                            </fieldset>
                        </div>

                        <div class="govuk-form-group  @hideFilterElements">
                            <fieldset class="govuk-fieldset">
                                <legend class="govuk-fieldset__legend govuk-fieldset__legend--m">
                                    Event type
                                </legend>
                                <div class="govuk-checkboxes govuk-checkboxes--small">
                                    <div class="govuk-checkboxes__item">
                                        <input class="govuk-checkboxes__input" id="type-employer" name="type" type="checkbox" value="employer">
                                        <label class="govuk-label govuk-checkboxes__label" for="type-employer">
                                            Employer engagement events
                                        </label>
                                    </div>
                                </div>
                                <div class="govuk-checkboxes govuk-checkboxes--small">
                                    <div class="govuk-checkboxes__item">
                                        <input class="govuk-checkboxes__input" id="type-national" name="type" type="checkbox" value="national">
                                        <label class="govuk-label govuk-checkboxes__label" for="type-national">
                                            National/Regional meetings
                                        </label>
                                    </div>
                                </div>
                                <div class="govuk-checkboxes govuk-checkboxes--small">
                                    <div class="govuk-checkboxes__item">
                                        <input class="govuk-checkboxes__input" id="type-school" name="type" type="checkbox" value="school">
                                        <label class="govuk-label govuk-checkboxes__label" for="type-school">
                                            School and College events
                                        </label>
                                    </div>
                                </div>
                                <div class="govuk-checkboxes govuk-checkboxes--small">
                                    <div class="govuk-checkboxes__item">
                                        <input class="govuk-checkboxes__input" id="type-careers" name="type" type="checkbox" value="careers">
                                        <label class="govuk-label govuk-checkboxes__label" for="type-careers">
                                            Careers events
                                        </label>
                                    </div>
                                </div>
                                <div class="govuk-checkboxes govuk-checkboxes--small">
                                    <div class="govuk-checkboxes__item">
                                        <input class="govuk-checkboxes__input" id="type-social" name="type" type="checkbox" value="social">
                                        <label class="govuk-label govuk-checkboxes__label" for="type-social">
                                            Social/Networking activity
                                        </label>
                                    </div>
                                </div>
                                <div class="govuk-checkboxes govuk-checkboxes--small">
                                    <div class="govuk-checkboxes__item">
                                        <input class="govuk-checkboxes__input" id="type-training" name="type" type="checkbox" value="training">
                                        <label class="govuk-label govuk-checkboxes__label" for="type-training">
                                            Training events
                                        </label>
                                    </div>
                                </div>
                                <div class="govuk-checkboxes govuk-checkboxes--small">
                                    <div class="govuk-checkboxes__item">
                                        <input class="govuk-checkboxes__input" id="type-other" name="type" type="checkbox" value="other">
                                        <label class="govuk-label govuk-checkboxes__label" for="type-other">
                                            Other
                                        </label>
                                    </div>
                                </div>
                            </fieldset>
                        </div>
                        <div class="govuk-form-group  @hideFilterElements">
                            <fieldset class="govuk-fieldset">
                                <legend class="govuk-fieldset__legend govuk-fieldset__legend--m">
                                    Region
                                </legend>
                                <div class="govuk-checkboxes govuk-checkboxes--small">
                                    <div class="govuk-checkboxes__item">
                                        <input class="govuk-checkboxes__input" id="region-national" name="region" type="checkbox" value="national">
                                        <label class="govuk-label govuk-checkboxes__label" for="region-national">
                                            National
                                        </label>
                                    </div>
                                </div>
                                <div class="govuk-checkboxes govuk-checkboxes--small">
                                    <div class="govuk-checkboxes__item">
                                        <input class="govuk-checkboxes__input" id="region-national" name="region" type="checkbox" value="national">
                                        <label class="govuk-label govuk-checkboxes__label" for="region-national">
                                            East Midlands
                                        </label>
                                    </div>
                                </div>
                                <div class="govuk-checkboxes govuk-checkboxes--small">
                                    <div class="govuk-checkboxes__item">
                                        <input class="govuk-checkboxes__input" id="region-national" name="region" type="checkbox" value="national">
                                        <label class="govuk-label govuk-checkboxes__label" for="region-national">
                                            East of England
                                        </label>
                                    </div>
                                </div>
                                <div class="govuk-checkboxes govuk-checkboxes--small">
                                    <div class="govuk-checkboxes__item">
                                        <input class="govuk-checkboxes__input" id="region-national" name="region" type="checkbox" value="national">
                                        <label class="govuk-label govuk-checkboxes__label" for="region-national">
                                            London
                                        </label>
                                    </div>
                                </div>
                                <div class="govuk-checkboxes govuk-checkboxes--small">
                                    <div class="govuk-checkboxes__item">
                                        <input class="govuk-checkboxes__input" id="region-national" name="region" type="checkbox" value="national">
                                        <label class="govuk-label govuk-checkboxes__label" for="region-national">
                                            North East
                                        </label>
                                    </div>
                                </div>
                                <div class="govuk-checkboxes govuk-checkboxes--small">
                                    <div class="govuk-checkboxes__item">
                                        <input class="govuk-checkboxes__input" id="region-national" name="region" type="checkbox" value="national">
                                        <label class="govuk-label govuk-checkboxes__label" for="region-national">
                                            North West
                                        </label>
                                    </div>
                                </div>
                                <div class="govuk-checkboxes govuk-checkboxes--small">
                                    <div class="govuk-checkboxes__item">
                                        <input class="govuk-checkboxes__input" id="region-national" name="region" type="checkbox" value="national">
                                        <label class="govuk-label govuk-checkboxes__label" for="region-national">
                                            South East
                                        </label>
                                    </div>
                                </div>
                                <div class="govuk-checkboxes govuk-checkboxes--small">
                                    <div class="govuk-checkboxes__item">
                                        <input class="govuk-checkboxes__input" id="region-national" name="region" type="checkbox" value="national">
                                        <label class="govuk-label govuk-checkboxes__label" for="region-national">
                                            South West
                                        </label>
                                    </div>
                                </div>
                                <div class="govuk-checkboxes govuk-checkboxes--small">
                                    <div class="govuk-checkboxes__item">
                                        <input class="govuk-checkboxes__input" id="region-national" name="region" type="checkbox" value="national">
                                        <label class="govuk-label govuk-checkboxes__label" for="region-national">
                                            West Midlands
                                        </label>
                                    </div>
                                </div>
                                <div class="govuk-checkboxes govuk-checkboxes--small">
                                    <div class="govuk-checkboxes__item">
                                        <input class="govuk-checkboxes__input" id="region-national" name="region" type="checkbox" value="national">
                                        <label class="govuk-label govuk-checkboxes__label" for="region-national">
                                            Yorkshire and the Humber
                                        </label>
                                    </div>
                                </div>
                            </fieldset>
                        </div>
                        <button type="submit" class="govuk-button" id="filters-submit-second">Apply filters</button>
                    </form>
                </div>
            </div>
            <button class="govuk-button das-filter__toggle das-show-hide__button govuk-visually-hidden" data-button-string="filter " data-aria-controls="events-filter" aria-expanded="true">Show filter </button>
        </div>
    </div>
    <div class="govuk-grid-column-two-thirds">
        <h2 class="govuk-heading-m">@totalCountDescription</h2>
        <p class="govuk-body govuk-!-margin-bottom-6  govuk-visually-hidden">
            Sorted by:
            <span class="govuk-!-font-weight-bold">Name</span>
        </p>
        <hr class="govuk-section-break govuk-section-break--visible govuk-!-margin-bottom-3 ">
        <div class="das-search-results">

            <ol class="das-search-results__list">

                @foreach (var calendarEvent in Model.CalendarEvents)
                {
                    <li class="das-search-results__list-item">
                        <div class="govuk-grid-row">
                            <div class="govuk-grid-column-three-quarters das-!-float-right">
                                <h2 class="govuk-heading-m das-search-results__heading">
                                    <a class="das-search-results__link" href="#">
                                        @calendarEvent.Summary
                                    </a>
                                </h2>
                                <p class="govuk-body das-search-results__body">@calendarEvent.Description</p>
                                <dl class="das-definition-list das-definition-list--inline">
                                    <dt class="das-definition-list__title">Date</dt>
                                    <dd class="das-definition-list__definition">@calendarEvent.Start.Date.ToString("d MMMM yyyy")</dd>
                                    <dt class="das-definition-list__title">Time</dt>
                                    <dd class="das-definition-list__definition">@calendarEvent.Start.ToString("h:mmtt").ToLower() - @calendarEvent.End.ToString("h:mmtt").ToLower()</dd>
                                    <dt class="das-definition-list__title">Where</dt>
                                    <dd class="das-definition-list__definition">
                                        @calendarEvent.Location
                                        @if (calendarEvent.EventFormat != EventFormat.Online && calendarEvent.Latitude != null && calendarEvent.Longitude != null)
                                        {
                                            <a href="https://www.google.com/maps/dir/@calendarEvent.Latitude,@calendarEvent.Longitude" rel="noopener" target="_blank" class="govuk-link">(view map in a new window)</a>
                                        }
                                    </dd>
                                    @if (calendarEvent.EventFormat != EventFormat.Online && calendarEvent.Distance != null)
                                    {
                                        <dt class="das-definition-list__title">Distance</dt>
                                        <dd class="das-definition-list__definition">@calendarEvent.Distance?.ToString("0.0") miles</dd>

                                    }
                                    <dt class="das-definition-list__title">Event type</dt>
                                    <dd class="das-definition-list__definition">@calendarEvent.CalendarName</dd>
                                </dl>
                            </div>
                            <div class="govuk-grid-column-one-quarter">
                                <div class="govuk-body app-date">
                                    <span class="app-date__day">@calendarEvent.Start.Date.Day.ToString("0")</span>
                                    <span class="app-date__month">@calendarEvent.Start.Date.ToString("MMM")</span>
                                </div>
                                <strong class="govuk-tag app-tag app-tag--@calendarEvent.EventFormat.ToString()">@calendarEvent.EventFormat.GetDescription()</strong>
                                <partial name="_IsAttending" model=calendarEvent.IsAttending />
                            </div>
                        </div>
                    </li>
                }
            </ol>
        </div>
    </div>
</div>